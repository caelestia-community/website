---
import Logo from '../core/Logo.astro';
const { label = "Desktop" } = Astro.props;
const time = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
---

<!-- Vertical Sidebar Container -->
<div class="fixed bottom-0 left-0 w-full h-16 md:top-0 md:h-full md:w-[4.5rem] flex md:flex-col flex-row items-center justify-between md:justify-start px-6 md:px-0 py-0 md:py-4 z-50 transition-all duration-300 bg-black/20 backdrop-blur-lg md:bg-transparent border-t border-white/5 md:border-t-0">
    
    <!-- Top Module: Status (Logo) -->
    <div class="mb-0 md:mb-auto flex shrink-0">
        <a href="/" class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white/5 text-subtext hover:text-text transition-colors" aria-label="Go to Home">
             <Logo class="w-6 h-6" />
        </a>
    </div>

    <!-- Center Module: Desktop Text (Hidden on mobile) -->
    <div class="hidden md:block absolute top-1/2 -translate-y-1/2 writing-mode-vertical text-sm font-bold tracking-[0.2em] text-[#e0def4] opacity-80 select-none">
        {label}
    </div>
    
    <!-- Workspace Indicator (Hidden/Subtle) -->
    <div class="hidden">
        <!-- Kept for state preservation if needed, but hidden for visual match -->
    </div>

    <!-- Bottom Module: Controls -->
    <div class="mt-0 md:mt-auto flex flex-row md:flex-col items-center gap-4">
        
        <!-- Clock (Vertical) -->
        <!-- Clock (Vertical) -->
        <div class="hidden md:flex flex-col items-center gap-1 text-text select-none group" title="Calendar">
            <!-- Calendar Icon -->
            <div class="mb-1 group-hover:text-primary transition-colors opacity-80">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>
            </div>
            
            <!-- Time Stack -->
            <div class="flex flex-col items-center gap-0 leading-tight font-mono text-lg font-bold opacity-80">
                <span id="clock-hour">--</span>
                <span id="clock-min">--</span>
                <span id="clock-ampm" class="text-xs font-medium opacity-60 mt-0.5">--</span>
            </div>
        </div>

        <div class="w-px h-8 md:w-8 md:h-px bg-white/10"></div>

        <!-- System Tray -->
        <div class="flex flex-row md:flex-col gap-2">
            
            <!-- Launcher Toggle (Grid) -->
             <button onclick="window.toggleLauncher()" class="w-10 h-10 flex items-center justify-center rounded-xl bg-surface/50 hover:bg-primary/20 text-subtext hover:text-primary transition-colors group relative" title="App Launcher">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="group-hover:scale-110 transition-transform"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
            </button>

            <!-- Theme/Panel Toggle -->
            <button onclick="window.toggleThemePanel()" class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white/10 transition-colors text-subtext hover:text-primary group" aria-label="Open Theme Panel">
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="group-hover:scale-110 transition-transform"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
            </button>

            <!-- Documentation -->
            <a href="/docs/core/shell" class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white/10 transition-colors text-subtext hover:text-text group" aria-label="Documentation">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="group-hover:scale-110 transition-transform"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            </a>
            
            <!-- Power Button -->
            <button class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-red-500/20 text-error transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="group-hover:scale-110 transition-transform"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
            </button>
        </div>
    </div>
</div>

<style>
    .writing-mode-vertical {
        writing-mode: vertical-lr;
    }
</style>

<script is:inline>
    function updateClock() {
        const now = new Date();
        let hours = now.getHours();
        const minutes = now.getMinutes();
        const ampm = hours >= 12 ? 'PM' : 'AM';
        
        hours = hours % 12;
        hours = hours ? hours : 12; // the hour '0' should be '12'
        
        // Pad single digits? User image shows "11", "57". "11" is 2 digits.
        // Usually vertical clocks align better with zero padding.
        const strHours = hours.toString().padStart(2, '0');
        const strMin = minutes.toString().padStart(2, '0');

        const elHour = document.getElementById('clock-hour');
        const elMin = document.getElementById('clock-min');
        const elAmpm = document.getElementById('clock-ampm');

        if(elHour) elHour.textContent = strHours;
        if(elMin) elMin.textContent = strMin;
        if(elAmpm) elAmpm.textContent = ampm;
    }

    // Init
    updateClock();
    // Update every second for sync, though display is minute-precision
    setInterval(updateClock, 1000);
</script>
